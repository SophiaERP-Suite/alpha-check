import{b as s,M as l,L as c,R as r}from"./index.mw6FRxF7.js";import{i}from"./index.umd.K5bD--n6.js";import"./tiny-invariant.BHpmfUqq.js";const d=()=>{if(typeof document>"u")return;let t;const n=document.getElementsByTagName("link");for(let e=0;e<n.length;e++){const o=n[e].getAttribute("rel");o&&["icon","shortcut icon"].includes(o)&&(t=n[e].getAttribute("href")||void 0)}if(t)try{return new URL(t).href}catch{return`${document.location.origin}/${t.replace("/","")}`}},p=()=>{var e;const t=d(),n=(e=document.querySelector("meta[property='og:site_name']"))==null?void 0:e.getAttribute("content");return{url:document.location.origin,name:n||document.title,icon:t}};window.addEventListener(i.RequestType.JSON_RPC,async t=>{const n=t.detail,e=n.payload.id;try{const o=p(),a=await s.runtime.sendMessage({type:l.ASK_PROVIDER_FROM_CONTENT_SCRIPT,message:{...n.payload},peerMeta:o});window.postMessage(JSON.stringify(a),window.location.origin)}catch(o){c.error("JSON_RPC",o);const a={isWalletEvent:!0,type:i.WalletEventType.JSON_RPC_RESPONSE,data:{jsonrpc:"2.0",error:o,id:e,result:void 0}};window.postMessage(JSON.stringify(a),window.location.origin)}},!1);s.runtime.onMessage.addListener((t,n)=>{if(s.runtime.id!==n.id)return console.error(`Receiving message from unauthorized sender ${n}.`),Promise.reject();switch(t.roninEvent){case r.ACCOUNTS_CHANGED:{const e={isWalletEvent:!0,type:i.WalletEventType.ACCOUNTS_CHANGED,data:t.payload};return window.postMessage(JSON.stringify(e),window.location.origin),Promise.resolve(!0)}case r.CHAIN_ID_CHANGED:{const e={isWalletEvent:!0,type:i.WalletEventType.CHAIN_CHANGED,data:t.payload};return window.postMessage(JSON.stringify(e),window.location.origin),Promise.resolve(!0)}case r.UNLOCK_CHANGED:{const e={isWalletEvent:!0,type:i.WalletEventType.ACCOUNTS_CHANGED,data:[]};return window.postMessage(JSON.stringify(e),window.location.origin),Promise.resolve(!0)}case r.ACCOUNT_CHANGED:{const e={direction:"from-ronin-content-script",roninEvent:r.ACCOUNT_CHANGED,detail:t.payload};return window.postMessage(e,window.location.origin),Promise.resolve(!0)}}});setInterval(()=>{s.runtime.sendMessage({type:l.KEEP_ALIVE_FROM_CONTENT_SCRIPT})},1e4);const u=()=>{setTimeout(()=>{const t={isWalletEvent:!0,type:i.WalletEventType.CONTENT_SCRIPT_READY};window.postMessage(JSON.stringify(t),window.location.origin)},100)};u();
